<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>ActiveRecord-Tutorial</title>
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
<div class="container">
	<h1>Bienvenido al tutorial de ActiveRecord</h1>
</div>

<div class="container-fluid">
	<div class="panel-group" id="tutorial">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title color1 ">
					<a data-toggle="collapse" data-parent="#tutorial" href="#introduccion">INTRODUCCION Y REQUISITOS<span class="glyphicon glyphicon-triangle-bottom pull-right" aria-hidden="true"></span></a>
				</h3>
			</div>
			<div id="introduccion" class="panel-collapse collapse in">
				<div class="panel-body">
					<div class="container">
						<div class="form-group row">
							<div class="col-lg-2">
								<img src="images/ruby.png" alt="" class="img-responsive">
							</div>
							<div class="form-group ">
							<h3>Introducción</h3>
								<p>
									Active Record es la M en MVC - el modelo - el cual es la capa del sistema responsable de representar los datos y la lógica de negocio para manipularlos. Active Record facilita la creación y manipulación de objetos de negocio quienes requieren ser almacenados persistentemente en una base de datos. Esta es una implementación del patrón de Active Record el cual en si mismo es una descripción de un sistema de Mapeo de Objetos Relacionales.
								</p>
							</div>
						</div>
					</div>
					<div class="container">
						<div class="form-group row">
							<div class="form-group col-lg-10">
								<h3>Requisitos</h3>
								<ul>
									<li>Un PC con una distribución de Linux o una maquina virtual como <a href="https://c9.io">C9.io</a></li>
									<li>Conocimiento básico de Ruby on Rails</li>
									<li>Muchas ganas <span class="glyphicon glyphicon-fire red"></span></li>
								</ul>
							</div>
							<div class="col-lg-2">
								<img src="images/linux.png" alt="" class="img-responsive">
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title color1 ">
					<a data-toggle="collapse" data-parent="#tutorial" href="#inicio">INICIEMOS:<span class="glyphicon glyphicon-triangle-bottom pull-right" aria-hidden="true"></span></a>
				</h3>
			</div>
			<div id="inicio" class="panel-colapse collapse">
				<div class="panel-body">
					<div class="container">
						<p>Para empezar vamos a crear un proyecto en rails con el nombre ‘Ejm’:</p>
						<div class="text-primary col-lg-offset-1">
							<dd>$ rails new Ejm</dd>
						</div>
						<br>
						<p>Ahora generemos unas cuantas entidades para verificar el tipo de variables que admiten, visualizar que métodos crea y como vincula los modelos:</p>
						<div class="text-primary col-lg-offset-1">
							<dd>$ rails generate scaffold Article code_bar:integer name:string price:integer stock:integer weight:integer color:string description:string </dd>
							<dd>$ rails generate scaffold Client name:string phone:integer address:string city:string </dd>
							<dd>$ rails generate scaffold Employee name:string birthday:date</dd>
						</div>
						<p>Tambien estan disponibles estos tipos de variables:</p>
						<li>binary</li>
						<li>boolean</li>
						<li>datetime</li>
						<li>decimal</li>
						<li>float</li>
						<li>integer</li>
						<li>primary_key</li>
						<li>text</li>
						<li>time</li>
						<li>timestamp</li>
					</div>
					<div class="container">
						<div class="panel-group" id="scaffoldTotal">
							<div class="panel panel-default">
								<div class="panel-heading">
									<h4 class="panel-title color1">
										<a href="#scaffold" data-toggle="collapse" data-parent="#scaffoldTotal">En este espacio podrás ver el resultado de las anteriores líneas si se desarrollaron correctamente <span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span>
										</a>
									</h4>
								</div>
								<div id="scaffold" class=" panel-collapse collapse">
									<div class="panel-body">
										<div class="">
											Scaffold:
											<img src="images/Scaffold.png" alt="" class="img-responsive">
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="panel panel-default">
			<div class="panel-heading">
				<h4 class="panel-title color1">
					<a data-toggle="collapse" data-parent="#tutorial" href="#lecturaEscritura">LEYENDO Y ESCRIBIENDO DATOS<span class="glyphicon glyphicon-triangle-bottom pull-right" aria-hidden="true"></span></a>
				</h4>
			</div>
			<div class="panel-collapse collapse" id="lecturaEscritura">
				<div class="panel-body">
					<div class="container">
					<p>CRUD es el acronismo para las cuatro verbos que utilizamos para operar con los datos: Create,Read, Update and Delete. Active Record automáticamente crea métodos que permiten a una aplicación leer y manipular los datos guardados dentro de las tablas.</p>
					<h5><strong>CREAR</strong> </h5>
					<div class="col-lg-offset-1">
						<p>
						Para agregar registros a una tabla se debe entrar por la consola de rails, para esto basta con ingresar el comando rails console una vez dentro de la consola de rails se usa el nombre de la clase o tabla	para crear los registros
						</p>
						<p>Ejm <em class="text-primary">$ user = User.create(name: "David", occupation: "Code Artist")</em></p>
						<p>Ahora intenta crear un registro en la tabla client con los siguientes datos: Teléfono: 1234567, Dirección: cra 68 # 26-50, Ciudad: Bogotá
						</p>
						<br>
						<div class="container row col-lg-12">
							<div id="r1" class="panel-group">
								<div class="panel panel-default">
									<div class="panel-heading">
										<h4 class="panel-title color1">
											<a data-toggle="collapse" data-parent="#r1" href="#respuesta1">El resultado debería ser:<span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span></a>
										</h4>
									</div>
									<div class="panel-collapse collapse" id="respuesta1">
										<div class="panel-body">
										<div class="container">
											<div class="form-group row">
												<div class="col-lg-10">
													<img src="images/CrearClienteSV.png" alt="" class="img-responsive">
												</div>
											</div>
										</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="row col-lg-12">
						<p>Otra forma de crear objetos es:</p>
						<p class="text-center text-primary">$ user = User.new</p>
						<p class="text-center text-primary">$ user.name = "David"</p>
						<p class="text-center text-primary">$ user.occupation = "Code Artist"</p>
						<p>Y finamente se guarda porque hasta el momento el objeto no es persistente</p>
						<p class="text-center text-primary">$ user.save</p>
						</div>
					</div>
					<h5><strong>LEER</strong> </h5>
					<div class="col-lg-offset-1">
						<p>
							Active Record provee una rica API para acceder a los datos dentro de una base de datos. Debajo hay algunos ejemplos de diferentes métodos provistos por Active Record.
							Entre ellos:
						</p>
						<div class="row col-lg-12">
							<p class="text-center text-primary">$ model.all</p>
							<p>Devuelve la colección completa en la base de datos, inténtalo</p>
							<div class="container row col-lg-12">
								<div id="clienteAll" class="panel-group">
									<div class="panel panel-default">
										<div class="panel-heading">
											<h4 class="panel-title color1">
												<a data-toggle="collapse" data-parent="#clienteAll" href="#cliente1">Deberias tener algo asi:<span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span></a>
											</h4>
										</div>
										<div class="panel-collapse collapse" id="cliente1">
											<div class="panel-body">
												<div class="container">
													<img src="images/clienttAll.png" alt="" class="img-responsive">
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="container row col-lg-12">
							<br>
							<p class="text-center text-primary">$ model.find_by(NombreParametro: parametro)</p>
							<p>Retorna los objetos que coincidan con este parámetro, de lo contrario retorna nulo</p>
							</div>
							<div class="container row col-lg-12">
								<div id="clientby" class="panel-group">
									<div class="panel panel-default">
										<div class="panel-heading">
											<h4 class="panel-title color1">
												<a data-toggle="collapse" data-parent="#clientby" href="#client2">Y el retorno debería verse así:<span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span></a>
											</h4>
										</div>
										<div class="panel-collapse collapse" id="client2">
											<div class="panel-body">
												<div class="container">
													<img src="images/clientBy.png" alt="" class="img-responsive">
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<h5><strong>EDITAR</strong> </h5>
					<div class="col-lg-offset-1">
						<p>
							ActiveRecord también nos permite editar los objetos ya sea uno a uno o todos al tiempo
						</p>
						<br>
						<div class="row col-lg-14">
							<p class="text-center text-primary">$ temp = Model.find_by(NombreParametro: 'atributo')</p>
							<p class="text-center text-primary">$ temp.update(NombreParametroX: 'atributo')</p>	
						</div>
						<p>El cual permite recuperar un registro y alterarlo y de nuevo subirlo al modelo</p>
						<br>
						<div class="row col-lg-12">
							<p class="text-center text-primary">$ Model.update_all "NombreParametro = 'ValorParametro'"</p>
						</div>
						<p>Permite actualizar todos los objetos del modelo con una sola línea, claro si no poseen restricciones.</p>
						<div class="container row col-lg-12">
							<div id="clientUpdate" class="panel-group">
								<div class="panel panel-default">
									<div class="panel-heading">
										<h4 class="panel-title color1">
											<a data-toggle="collapse" data-parent="#clientUpdate" href="#client3">Y el resultado sera:<span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span></a>
										</h4>
									</div>
									<div class="panel-collapse collapse" id="client3">
										<div class="panel-body">
											<div class="container">
												<img src="images/clientUpdate.png" alt="" class="img-responsive">
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<h5><strong>BORRAR</strong> </h5>
					<div class="col-lg-offset-1">
						<p>
							Asimismo, una vez que se recupera el objeto Active Record también puede ser destruído, lo cual lo borrará de la base de datos.
						</p>
						<div class="row col-lg-12">
							<p class="text-center text-primary">$ temp = Model.find_by(NombreParametro: 'ValorParametro')</p>
							<p class="text-center text-primary">$ temp.destroy</p>
						</div>
					</div>
					</div>
				</div>
			</div>
		</div>
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title color1 ">
					<a data-toggle="collapse" data-parent="#tutorial" href="#validaciones">VALIDACIONES: <span class="glyphicon glyphicon-triangle-bottom pull-right" aria-hidden="true"></span></a>
				</h3>
			</div>
			<div class="panel-collapse collapse" id="validaciones">
				<div class="panel-body">
					<div class="container">
						<p> La validación es una tarea muy importante a considerar cuando se guardan datos en una base de datos, entonces los métodos save y update toman esto en cuenta cuando se ejecutan: ellos retornan false cuando una validación falla y no mantuvieron ninguna operación en la base de datos</p>
						<p>Intentemos con los modelos como los tenemos crear un objeto en Client sin parámetros de validación:</p>
						<div class="text-primary col-lg-offset-1">
							<dd>$ Client.create(name:"", phone:1234567, address:"cra 68 # 26-50", city:"Bogotá")</dd>
						</div>
						<br>
					</div>
					<div class="container">
						<div id="addClienteNV" class="panel-group">
							<div class="panel panel-default">
								<div class="panel-heading">
									<h4 class="panel-title color1">
										<a data-toggle="collapse" data-parent="#addClienteNV" href="#addClienteNV1">El resultado seria:<span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span>
										</a>
									</h4>
								</div>
								<div class="panel-collapse collapse" id="addClienteNV1">
									<div class="panel-body">
										<div class="">
											<img src="images/CrearClienteSV.png" alt="" class="img-responsive">
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="container">
						<p>A continuación Creamos validaciones para el modelo Client:</p>
						<div class="text-primary col-lg-offset-1">
							<dd>$ class Client < ApplicationRecord
	validates :name, presence: true, length: { minimum: 2 } <kbd> el campo name es obligatorio y la longitud debe ser mínimo 2 caracteres</kbd> 
							</dd>
							<dd>$ validates :phone, numericality: true, length: {in: 7..11}, uniqueness: true
							<kbd>es numérico y único, además la longitud debe ser entre 7 y 11</kbd>
							</dd>
							<dd>
								$ validates :address, presence: true
								<kbd>el campo es obligatorio</kbd>
							</dd>
							<dd>
								$ validates :city, format: { with: /\A[a-zA-Z]+\z/, message: "only allows letters" }
								<kbd>solo cadenas a-z, A-Z</kbd>
							</dd>
						</div>
						<br>
						<p>Tenga en cuenta que esto se hace en el directorio donde esta declarada la clase Cliente y que hereda de ApplicationRecord</p>
						<br>
						<p>Ahora mostraremos la validación de un registro sin campos correctos:</p>
						<img src="images/validarAll.png" alt="" class="img-responsive">
						<br>
						<p>Mostraremos el esperado del directorio modificado para validar y algunos errores al intentar validar cada variable.</p>
						<div class="container">
						<div id="validacionesAll" class="panel-group">
							<div class="panel panel-default">
								<div class="panel-heading">
									<h4 class="panel-title color1">
										<a data-toggle="collapse" data-parent="#validacionesAll" href="#validarDir">Directorio client.rb modificado<span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span></a>
									</h4>
								</div>
									<div class="panel-collapse collapse" id="validarDir">
									<div class="panel-body">
										<div class="">
											<img src="images/configValidacion.png" alt="" class="img-responsive">
										</div>
									</div>
								</div>
							</div>
							<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title color1">
									<a data-toggle="collapse" data-parent="#validacionesAll" href="#validar1">Validando regla validates :name, presence: true<span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span></a>
								</h4>
							</div>
							<div class="panel-collapse collapse" id="validar1">
								<div class="panel-body">
									<div class="container">
										<img src="images/validar1.png" alt="" class="img-responsive">
									</div>
								</div>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title color1">
									<a data-toggle="collapse" data-parent="#validacionesAll" href="#validar2">Validando regla validates :name, length: { minimum: 2 }<span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span></a>
								</h4>
							</div>
								<div class="panel-collapse collapse" id="validar2">
								<div class="panel-body">
									<div class="container">
										<img src="images/validar2.png" alt="" class="img-responsive">
									</div>
								</div>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title color1">
									<a data-toggle="collapse" data-parent="#validacionesAll" href="#validar3">Validando la regla validates :phone, length: {in: 7..11}<span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span></a>
								</h4>
							</div>
							<div class="panel-collapse collapse" id="validar3">
								<div class="panel-body">
									<div class="container">
										<img src="images/validar3.png" alt="" class="img-responsive">
										<img src="images/validar3-1.png" alt="" class="img-responsive">
									</div>
								</div>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title color1">
									<a data-toggle="collapse" data-parent="#validacionesAll" href="#validar4">Validando la regla validates :phone, numericality: true<span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span></a>
								</h4>
							</div>
							<div class="panel-collapse collapse" id="validar4">
								<div class="panel-body">
									<div class="container">
										<img src="images/validar4.png" alt="" class="img-responsive">
									</div>
								</div>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title color1">
									<a data-toggle="collapse" data-parent="#validacionesAll" href="#validar5">Validando la regla validates :phone, uniqueness: true<span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span></a>
								</h4>
							</div>
							<div class="panel-collapse collapse" id="validar5">
								<div class="panel-body">
									<div class="container">
										<img src="images/validar5.png" alt="" class="img-responsive">
										<img src="images/validar5-1.png" alt="" class="img-responsive">
									</div>
								</div>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title color1">
									<a data-toggle="collapse" data-parent="#validacionesAll" href="#validar6">Validando la regla validates :address, presence: true<span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span></a>
								</h4>
							</div>
							<div class="panel-collapse collapse" id="validar6">
								<div class="panel-body">
									<div class="container">
										<img src="images/validar6.png" alt="" class="img-responsive">
									</div>
								</div>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title color1">
									<a data-toggle="collapse" data-parent="#validacionesAll" href="#validar7">Validando la regla  validates :city, format: { with: /\A[a-zA-Z]+\z/, message: "only allows letters" }<span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span></a>
								</h4>
							</div>
							<div class="panel-collapse collapse" id="validar7">
								<div class="panel-body">
									<div class="container">
										<img src="images/validar7.png" alt="" class="img-responsive">
									</div>
								</div>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title color1">
									<a data-toggle="collapse" data-parent="#validacionesAll" href="#validar8"><strong>REGISTRO EXITOSO</strong><span class="glyphicon glyphicon-collapse-down pull-right" aria-hidden="true"></span></a>
								</h4>
							</div>
							<div class="panel-collapse collapse" id="validar8">
								<div class="panel-body">
									<div class="container">
										<img src="images/validar8.png" alt="" class="img-responsive">
									</div>
								</div>
							</div>
						</div>
						</div>
					</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

	<script src="js/jquery.js"></script>
	<script src="js/bootstrap.min.js"></script>
</body>
</body>
</html>